"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4189],{94189:(Pe,T,_)=>{_.r(T),_.d(T,{Tab1PageModule:()=>Te});var f=_(11929),P=_(96814),h=_(60095),M=_(23554),Z=_(96116),b=_(15861),E=_(66588),L=_(22832),J=_(74825),e=_(85678),y=_(28251),z=_(6593);const B=["qrcElement"];let q=(()=>{var n;class i{constructor(t,o){this.renderer=t,this.sanitizer=o,this.allowEmptyString=!1,this.colorDark="#000000ff",this.colorLight="#ffffffff",this.cssClass="qrcode",this.elementType="canvas",this.errorCorrectionLevel="M",this.margin=4,this.qrdata="",this.scale=4,this.width=10,this.qrCodeURL=new e.vpe,this.context=null}ngOnChanges(){var t=this;return(0,b.Z)(function*(){yield t.createQRCode()})()}isValidQrCodeText(t){return!1===this.allowEmptyString?!(typeof t>"u"||""===t||"null"===t||null===t):!(typeof t>"u")}toDataURL(t){return new Promise((o,c)=>{(0,y.toDataURL)(this.qrdata,t,(a,l)=>{a?c(a):o(l)})})}toCanvas(t,o){return new Promise((c,a)=>{(0,y.toCanvas)(t,this.qrdata,o,l=>{l?a(l):c("success")})})}toSVG(t){return new Promise((o,c)=>{(0,y.toString)(this.qrdata,t,(a,l)=>{a?c(a):o(l)})})}renderElement(t){for(const o of this.qrcElement.nativeElement.childNodes)this.renderer.removeChild(this.qrcElement.nativeElement,o);this.renderer.appendChild(this.qrcElement.nativeElement,t)}createQRCode(){var t=this;return(0,b.Z)(function*(){t.version&&t.version>40?(console.warn("[angularx-qrcode] max value for `version` is 40"),t.version=40):t.version&&t.version<1?(console.warn("[angularx-qrcode]`min value for `version` is 1"),t.version=1):void 0!==t.version&&isNaN(t.version)&&(console.warn("[angularx-qrcode] version should be a number, defaulting to auto."),t.version=void 0);try{if(!t.isValidQrCodeText(t.qrdata))throw new Error("[angularx-qrcode] Field `qrdata` is empty, set 'allowEmptyString=\"true\"' to overwrite this behaviour.");t.isValidQrCodeText(t.qrdata)&&""===t.qrdata&&(t.qrdata=" ");const o={color:{dark:t.colorDark,light:t.colorLight},errorCorrectionLevel:t.errorCorrectionLevel,margin:t.margin,scale:t.scale,version:t.version,width:t.width},c=t.imageSrc,a=t.imageHeight||40,l=t.imageWidth||40;switch(t.elementType){case"canvas":{const s=t.renderer.createElement("canvas");t.context=s.getContext("2d"),t.toCanvas(s,o).then(()=>{if(t.ariaLabel&&t.renderer.setAttribute(s,"aria-label",`${t.ariaLabel}`),t.title&&t.renderer.setAttribute(s,"title",`${t.title}`),c&&t.context){t.centerImage=new Image(l,a),c!==t.centerImage.src&&(t.centerImage.src=c),a!==t.centerImage.height&&(t.centerImage.height=a),l!==t.centerImage.width&&(t.centerImage.width=l);const u=t.centerImage;u&&(u.onload=()=>{var d;null===(d=t.context)||void 0===d||d.drawImage(u,s.width/2-l/2,s.height/2-a/2,l,a)})}t.renderElement(s),t.emitQRCodeURL(s)}).catch(u=>{console.error("[angularx-qrcode] canvas error:",u)});break}case"svg":{const s=t.renderer.createElement("div");t.toSVG(o).then(u=>{t.renderer.setProperty(s,"innerHTML",u);const d=s.firstChild;t.renderer.setAttribute(d,"height",`${t.width}`),t.renderer.setAttribute(d,"width",`${t.width}`),t.renderElement(d),t.emitQRCodeURL(d)}).catch(u=>{console.error("[angularx-qrcode] svg error:",u)});break}default:{const s=t.renderer.createElement("img");t.toDataURL(o).then(u=>{t.alt&&s.setAttribute("alt",t.alt),t.ariaLabel&&s.setAttribute("aria-label",t.ariaLabel),s.setAttribute("src",u),t.title&&s.setAttribute("title",t.title),t.renderElement(s),t.emitQRCodeURL(s)}).catch(u=>{console.error("[angularx-qrcode] img/url error:",u)})}}}catch(o){console.error("[angularx-qrcode] Error generating QR Code:",o.message)}})()}emitQRCodeURL(t){const o=t.constructor.name;if(o===SVGSVGElement.name){const l=new Blob([t.outerHTML],{type:"image/svg+xml"}),s=URL.createObjectURL(l),u=this.sanitizer.bypassSecurityTrustUrl(s);return void this.qrCodeURL.emit(u)}let c="";o===HTMLCanvasElement.name&&(c=t.toDataURL("image/png")),o===HTMLImageElement.name&&(c=t.src),fetch(c).then(a=>a.blob()).then(a=>URL.createObjectURL(a)).then(a=>this.sanitizer.bypassSecurityTrustUrl(a)).then(a=>{this.qrCodeURL.emit(a)}).catch(a=>{console.error("[angularx-qrcode] Error when fetching image/png URL: "+a)})}}return(n=i).\u0275fac=function(t){return new(t||n)(e.Y36(e.Qsj),e.Y36(z.H7))},n.\u0275cmp=e.Xpm({type:n,selectors:[["qrcode"]],viewQuery:function(t,o){if(1&t&&e.Gf(B,7),2&t){let c;e.iGM(c=e.CRH())&&(o.qrcElement=c.first)}},inputs:{allowEmptyString:"allowEmptyString",colorDark:"colorDark",colorLight:"colorLight",cssClass:"cssClass",elementType:"elementType",errorCorrectionLevel:"errorCorrectionLevel",imageSrc:"imageSrc",imageHeight:"imageHeight",imageWidth:"imageWidth",margin:"margin",qrdata:"qrdata",scale:"scale",version:"version",width:"width",alt:"alt",ariaLabel:"ariaLabel",title:"title"},outputs:{qrCodeURL:"qrCodeURL"},features:[e.TTD],decls:2,vars:2,consts:[["qrcElement",""]],template:function(t,o){1&t&&e._UZ(0,"div",null,0),2&t&&e.Tol(o.cssClass)},encapsulation:2,changeDetection:0}),i})(),F=(()=>{var n;class i{}return(n=i).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({}),i})(),$=(()=>{var n;class i{constructor(t){this.modalCtrl=t}ngOnInit(){}get width(){return Math.round(.95*window.innerWidth)}}return(n=i).\u0275fac=function(t){return new(t||n)(e.Y36(f.IN))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-qrcode-modal"]],decls:4,vars:4,consts:[[1,"backdrop-color"],[3,"visible"],[1,"container-center"],[3,"qrdata","elementType","width"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-content",0),e._UZ(1,"ion-backdrop",1),e.TgZ(2,"div",2),e._UZ(3,"qrcode",3),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("visible",!0),e.xp6(2),e.Q6J("qrdata",o.qr_data)("elementType","img")("width",o.width))},dependencies:[f.ql,f.W2,q],styles:["ion-content[_ngcontent-%COMP%]{--background: #bebfc1 !important}"]}),i})();var G=_(63891),C=_(97582),H=_(65592),Y=_(92438),W={error:"cordova_not_available"},K={error:"plugin_not_installed"};function w(n){if(typeof window<"u"&&window.angular){var r=window.document,t=window.angular.element(r.querySelector("[ng-app]")||r.body).injector();if(t)return t.get("$q")(function(c,a){n(c,a)});console.warn("Angular 1 was detected but $q couldn't be retrieved. This is usually when the app is not bootstrapped on the html or body tag. Falling back to native promises which won't trigger an automatic digest when promises resolve.")}return function(){if(Promise)return new Promise(function(c,a){n(c,a)});console.error("No Promise support or polyfill found. To enable Ionic Native support, please add the es6-promise polyfill before this script, or run with a library like Angular or on a recent browser.")}()}function I(n,i,r){var t,o,c;return"string"==typeof n?t=n:(t=n.constructor.getPluginRef(),r=n.constructor.getPluginName(),c=n.constructor.getPluginInstallName()),!(!(o=R(t))||i&&typeof o[i]>"u")||(typeof window>"u"||!window.cordova?(function ne(n,i){typeof process>"u"&&console.warn(i?"Native: tried calling "+n+"."+i+", but Cordova is not available. Make sure to include cordova.js or run in a device/simulator":"Native: tried accessing the "+n+" plugin but Cordova is not available. Make sure to include cordova.js or run in a device/simulator")}(r,i),W):(function te(n,i,r){console.warn(r?"Native: tried calling "+n+"."+r+", but the "+n+" plugin is not installed.":"Native: tried accessing the "+n+" plugin but it's not installed."),i&&console.warn("Install the "+n+" plugin: 'ionic cordova plugin add "+i+"'")}(r,c,i),K))}function v(n,i,r,t,o,c){void 0===t&&(t={}),r=function A(n,i,r,t){if(void 0===i&&(i={}),i.sync)return n;if("reverse"===i.callbackOrder)n.unshift(t),n.unshift(r);else if("node"===i.callbackStyle)n.push(function(l,s){l?t(l):r(s)});else if("object"===i.callbackStyle&&i.successName&&i.errorName){var o={};o[i.successName]=r,o[i.errorName]=t,n.push(o)}else if(typeof i.successIndex<"u"||typeof i.errorIndex<"u"){var c=function(){i.successIndex>n.length?n[i.successIndex]=r:n.splice(i.successIndex,0,r)},a=function(){i.errorIndex>n.length?n[i.errorIndex]=t:n.splice(i.errorIndex,0,t)};i.successIndex>i.errorIndex?(a(),c()):(c(),a())}else n.push(r),n.push(t);return n}(r,t,o,c);var a=I(n,i);if(!0===a){var l=R(n.constructor.getPluginRef());return l[i].apply(l,r)}return a}function R(n){return typeof window<"u"?k(window,n):null}function k(n,i){for(var r=i.split("."),t=n,o=0;o<r.length;o++){if(!t)return null;t=t[r[o]]}return t}var U=function(){function n(){}return n.installed=function(){return!0===I(this.pluginRef)},n.getPlugin=function(){return typeof window<"u"?function ie(n,i){for(var r=i.split("."),t=n,o=0;o<r.length;o++){if(!t)return null;t=t[r[o]]}return t}(window,this.pluginRef):null},n.getPluginName=function(){return this.pluginName},n.getPluginRef=function(){return this.pluginRef},n.getPluginInstallName=function(){return this.plugin},n.getSupportedPlatforms=function(){return this.platforms},n.pluginName="",n.pluginRef="",n.plugin="",n.repo="",n.platforms=[],n.install="",n}();function x(n,i,r,t){return function(n,i,r){return void 0===r&&(r={}),function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return r.sync?v(n,i,t,r):r.observable?function X(n,i,r,t){return void 0===t&&(t={}),new H.y(function(o){var c;return c=t.destruct?v(n,i,r,t,function(){for(var a=[],l=0;l<arguments.length;l++)a[l]=arguments[l];return o.next(a)},function(){for(var a=[],l=0;l<arguments.length;l++)a[l]=arguments[l];return o.error(a)}):v(n,i,r,t,o.next.bind(o),o.error.bind(o)),c&&c.error&&(o.error(c.error),o.complete()),function(){try{if(t.clearFunction)return t.clearWithArgs?v(n,t.clearFunction,r,t,o.next.bind(o),o.error.bind(o)):v(n,t.clearFunction,[])}catch(a){console.warn("Unable to clear the previous observable watch for",n.constructor.getPluginName(),i),console.warn(a)}}})}(n,i,t,r):r.eventObservable&&r.event?function j(n,i){return i=typeof window<"u"&&i?k(window,i):i||(typeof window<"u"?window:{}),(0,Y.R)(i,n)}(r.event,r.element):r.otherPromise?function V(n,i,r,t){return void 0===t&&(t={}),w(function(o,c){var a=v(n,i,r,t);a?a.error?c(a.error):a.then&&a.then(o).catch(c):c({error:"unexpected_error"})})}(n,i,t,r):function O(n,i,r,t){void 0===t&&(t={});var o,c,a=w(function(l,s){o=t.destruct?v(n,i,r,t,function(){for(var u=[],d=0;d<arguments.length;d++)u[d]=arguments[d];return l(u)},function(){for(var u=[],d=0;d<arguments.length;d++)u[d]=arguments[d];return s(u)}):v(n,i,r,t,l,s),c=s});return o&&o.error&&(a.catch(function(){}),"function"==typeof c&&c(o.error)),a}(n,i,t,r)}}(n,i,r).apply(this,t)}!function D(){if(typeof process>"u"){var n=typeof window<"u"?window:{},r=Date.now(),t=!1;n.document.addEventListener("deviceready",function(){console.log("Ionic Native: deviceready event fired after "+(Date.now()-r)+" ms"),t=!0}),setTimeout(function(){!t&&n.cordova&&console.warn("Ionic Native: deviceready did not fire within 5000ms. This can happen when plugins are in an inconsistent state. Try removing plugins from plugins/ and reinstalling them.")},5e3)}}();var S=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return(0,C.ZT)(i,n),i.prototype.vibrate=function(r){return x(this,"vibrate",{sync:!0},arguments)},i.pluginName="Vibration",i.plugin="cordova-plugin-vibration",i.pluginRef="navigator",i.repo="https://github.com/apache/cordova-plugin-vibration",i.platforms=["Android","iOS","Windows"],i.decorators=[{type:e.GSi}],i}(U),ae=_(17911),ce=_(28615),Q=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return(0,C.ZT)(i,n),i.prototype.setBrightness=function(r){return x(this,"setBrightness",{},arguments)},i.prototype.getBrightness=function(){return x(this,"getBrightness",{},arguments)},i.prototype.setKeepScreenOn=function(r){return x(this,"setKeepScreenOn",{},arguments)},i.pluginName="Brightness",i.plugin="cordova-plugin-brightness",i.pluginRef="cordova.plugins.brightness",i.repo="https://github.com/mgcrea/cordova-plugin-brightness",i.platforms=["Android","iOS"],i.decorators=[{type:e.GSi}],i}(U);function se(n,i){1&n&&(e.ynx(0),e.TgZ(1,"div",4)(2,"p",5),e._uU(3,"Please login to continue"),e.qZA()(),e.BQk())}function le(n,i){if(1&n){const r=e.EpF();e.ynx(0),e.TgZ(1,"form",17),e.NdJ("ngSubmit",function(){e.CHM(r);const o=e.oxw(3);return e.KtG(o.lock_or_unlock())}),e._UZ(2,"ion-input",18),e.qZA(),e.BQk()}if(2&n){const r=e.oxw(3);e.xp6(1),e.Q6J("formGroup",r.myForm),e.xp6(1),e.s9C("errorText",r.qr_error)}}function ue(n,i){if(1&n&&(e.TgZ(0,"p",22),e._uU(1),e.qZA()),2&n){const r=e.oxw(4);e.xp6(1),e.hij("",r.qr_data_simplified," N")}}function de(n,i){if(1&n){const r=e.EpF();e.ynx(0),e.TgZ(1,"ion-button",19),e.NdJ("click",function(){e.CHM(r);const o=e.oxw(3);return e.KtG(o.openModal())}),e._UZ(2,"qrcode",20),e.qZA(),e.YNc(3,ue,2,1,"p",21),e.BQk()}if(2&n){const r=e.oxw(3);e.xp6(2),e.Q6J("qrdata",r.qr_data)("elementType","img")("width",r.imageHeight),e.xp6(1),e.Q6J("ngIf",r.qr_finalized)}}function ge(n,i){if(1&n){const r=e.EpF();e.ynx(0),e.TgZ(1,"ion-button",23),e.NdJ("click",function(){e.CHM(r);const o=e.oxw(3);return e.KtG(o.activate_receipt())}),e._UZ(2,"ion-icon",24),e.qZA(),e._UZ(3,"br"),e.TgZ(4,"span"),e._uU(5,"(right button) To display receipt when someone paid."),e.qZA(),e.BQk()}}function fe(n,i){if(1&n){const r=e.EpF();e.ynx(0),e.YNc(1,le,3,2,"ng-container",3)(2,de,4,4,"ng-container",3),e.TgZ(3,"ion-button",15),e.NdJ("click",function(){e.CHM(r);const o=e.oxw(2);return e.KtG(o.lock_or_unlock())}),e._UZ(4,"ion-icon",16),e.qZA(),e.YNc(5,ge,6,0,"ng-container",3),e.BQk()}if(2&n){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!r.qr_finalized),e.xp6(1),e.Q6J("ngIf",r.qr_finalized),e.xp6(1),e.Q6J("color",r.lock_color),e.xp6(1),e.Q6J("name",r.lock_unlock_name),e.xp6(1),e.Q6J("ngIf",!r.receipt_activated)}}function _e(n,i){if(1&n&&(e.TgZ(0,"div",25)(1,"ion-card")(2,"ion-card-header")(3,"ion-card-title",26),e._uU(4,"Receipt"),e.qZA()(),e.TgZ(5,"ion-card-content")(6,"ion-grid")(7,"ion-row")(8,"ion-col",27),e._uU(9),e.qZA(),e.TgZ(10,"ion-col",28),e._UZ(11,"ion-icon",29),e.qZA(),e.TgZ(12,"ion-col",27),e._uU(13),e.qZA()(),e.TgZ(14,"ion-row")(15,"ion-col",27),e._uU(16),e.qZA(),e.TgZ(17,"ion-col",28),e._UZ(18,"ion-icon",29),e.qZA(),e.TgZ(19,"ion-col",27),e._uU(20),e.qZA()(),e.TgZ(21,"ion-row"),e._UZ(22,"ion-col",30),e.TgZ(23,"ion-col",31),e._uU(24),e.qZA(),e._UZ(25,"ion-col",30),e.qZA(),e._UZ(26,"hr"),e.TgZ(27,"ion-row")(28,"ion-col",32),e._uU(29,"Paid:"),e.qZA(),e.TgZ(30,"ion-col",33),e._uU(31),e.qZA()(),e.TgZ(32,"ion-row")(33,"ion-col",32),e._uU(34,"Refund:"),e.qZA(),e.TgZ(35,"ion-col",33),e._uU(36),e.qZA()()()()()()),2&n){const r=e.oxw(2);let t;e.xp6(9),e.Oqu(r.curr_receipt.from),e.xp6(4),e.Oqu(r.curr_receipt.to),e.xp6(3),e.Oqu(r.curr_receipt.total),e.xp6(4),e.Oqu(r.curr_receipt.final_total),e.xp6(4),e.Oqu(r.curr_receipt.charges),e.xp6(7),e.Oqu(r.curr_receipt.paid),e.xp6(5),e.Oqu(null!==(t=r.curr_receipt.refund)&&void 0!==t?t:"0 N")}}function he(n,i){if(1&n){const r=e.EpF();e.TgZ(0,"ion-button",13),e.NdJ("click",function(){e.CHM(r);const o=e.oxw(2);return e.KtG(o.clear_txhash())}),e._uU(1,"Dismiss"),e.qZA()}}function me(n,i){if(1&n){const r=e.EpF();e.TgZ(0,"div",25),e._UZ(1,"ion-icon",34),e.TgZ(2,"p",35),e._uU(3,"Timeout"),e.qZA(),e.TgZ(4,"ion-button",13),e.NdJ("click",function(){e.CHM(r);const o=e.oxw(2);return e.KtG(o.reset_timeout())}),e._uU(5,"Dismiss"),e.qZA()()}}function pe(n,i){if(1&n){const r=e.EpF();e.TgZ(0,"ion-toggle",37),e.NdJ("ionChange",function(){e.CHM(r);const o=e.oxw(3);return e.KtG(o.on_single_change())}),e._uU(1),e.qZA()}if(2&n){const r=e.oxw(3);e.Q6J("checked",r.is_single)("disabled",r.qr_finalized),e.xp6(1),e.hij(" ",r.is_single_name," ")}}function ve(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const r=e.oxw(3);e.xp6(1),e.Oqu(r.is_single_name)}}function be(n,i){if(1&n&&(e.ynx(0),e.YNc(1,pe,2,3,"ion-toggle",36)(2,ve,2,1,"span",3),e._UZ(3,"div",25),e.BQk()),2&n){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!r.qr_finalized),e.xp6(1),e.Q6J("ngIf",r.qr_finalized)}}function we(n,i){if(1&n){const r=e.EpF();e.ynx(0),e.TgZ(1,"div",6)(2,"h3",7),e._uU(3),e.qZA()(),e._UZ(4,"div",8),e.TgZ(5,"div",9),e.YNc(6,fe,6,5,"ng-container",3)(7,_e,37,7,"div",10)(8,he,2,0,"ion-button",11)(9,me,6,0,"div",10),e.TgZ(10,"ion-button",12),e.NdJ("click",function(){e.CHM(r);const o=e.oxw();return e.KtG(o.max_brightness())}),e._uU(11,"Max"),e.qZA(),e.TgZ(12,"ion-button",13),e.NdJ("click",function(){e.CHM(r);const o=e.oxw();return e.KtG(o.reset_brightness())}),e._uU(13,"Reset"),e.qZA()(),e.TgZ(14,"div",14),e.YNc(15,be,4,2,"ng-container",3),e.qZA(),e.BQk()}if(2&n){const r=e.oxw();e.xp6(3),e.hij(' Warning! Check payment destination: "',r.contract_id,'" '),e.xp6(3),e.Q6J("ngIf",!r.curr_receipt&&!r.timeout_page),e.xp6(1),e.Q6J("ngIf",r.curr_receipt),e.xp6(1),e.Q6J("ngIf",r.curr_receipt),e.xp6(1),e.Q6J("ngIf",r.timeout_page),e.xp6(6),e.Q6J("ngIf",r.receipt_activated)}}const xe=[{path:"",component:(()=>{var n;class i{constructor(t,o,c,a,l,s,u){this.fb=t,this.walletSvc=o,this.vibration=c,this.toastSvc=a,this.miscSvc=l,this.modalCtrl=s,this.brightness=u,this.qr_finalized=!1,this.min_val=.001,this.max_val=5e7,this.single_interval=1500,this.receipt_activated=!0,this.is_single=!0,this.receipt_updated=!1,this.timeout_count=0,this.threshold_timeout=Math.round(200),this.timeout_page=!1}ngOnInit(){this.myForm=this.fb.group({price:[,[h.kI.required,h.kI.min(this.min_val),h.kI.max(this.max_val),h.kI.pattern("^[0-9]+(.[0-9]{0,5})?$")]]}),this.source=function N(n=0,i=L.z){return n<0&&(n=0),(0,J.H)(n,n,i)}(this.single_interval),setTimeout(()=>this.refresh_fn(),1e3)}ngOnDestroy(){this.subscription.unsubscribe()}handle_refresh(t){var o=this;return(0,b.Z)(function*(){o.refresh_fn(),t.target.complete()})()}refresh_fn(){var t=this;return(0,b.Z)(function*(){null!=t.walletSvc.account_id?t.walletSvc.view("receipt_activated",{account:t.walletSvc.account_id}).then(o=>{t.receipt_activated=o}).catch(o=>{t.receipt_activated=!1,console.error(o)}):t.receipt_activated=!1})()}get account_id(){var t;return null!==(t=this.walletSvc.account_id)&&void 0!==t?t:""}get contract_id(){return this.walletSvc.contract_id}get qr_data(){return`${this.account_id} ${this.myForm.get("price").value.toString()}`}get qr_data_simplified(){return`${this.miscSvc.alter_name(this.account_id)} ${this.myForm.get("price").value.toString()}`}get qr_error(){var t,o=null!==(t=this.myForm.get("price").errors)&&void 0!==t?t:{};return o.pattern?"Max 5 decimal place, numbers only.":o.min?`Minimum ${this.min_val} per transaction.`:o.max?`Maximum ${this.max_val} per transaction.`:null}get errors(){return this.myForm.get("price").errors}lock_or_unlock(){return this.errors?(this.myForm.get("price").markAsDirty(),this.toastSvc.present_toast(this.errors.required?"Please input price":`Error: ${this.qr_error}`,"top","bg-danger"),null):this.qr_finalized?this.unlock_price():this.lock_price()}get lock_unlock_name(){return this.qr_finalized?"lock-open-outline":"lock-closed-outline"}get lock_color(){return this.qr_finalized?"medium":"primary"}lock_price(){this.qr_finalized=!0,this.myForm.get("price").disable(),this.is_single&&(this.receipt_updated=!1,this.detect_receipt(),this.set_old_receipt())}unlock_price(){this.vibration.vibrate([300,500,800]),this.qr_finalized=!1,this.myForm.get("price").enable(),this.is_single&&this.stop_detect_receipt()}activate_receipt(){var t;this.walletSvc.call("activate_receipt",{},null!==(t=E.utils.format.parseNearAmount("0.1"))&&void 0!==t?t:"0")}get is_single_name(){return this.is_single?"Only one payment":"Accept multiple payments"}on_single_change(){this.is_single=!this.is_single}detect_receipt(){this.subscription=this.source.subscribe(t=>this._receipt_changed())}stop_detect_receipt(){this.old_receipt=null,this.receipt_updated=!1,this.timeout_count=0,this.subscription.unsubscribe()}clear_txhash(){this.unlock_price(),this.curr_receipt=null}_receipt_changed(){var t=this;return(0,b.Z)(function*(){if(""===t.account_id)return t.toastSvc.present_toast("wallet account_id is invalid. Please login and wait 3 seconds.","top","bg-danger"),void t.stop_detect_receipt();let o=yield t.walletSvc.view("latest_transaction",{account:t.account_id});t.compare_receipt(t.old_receipt,o)||(t.curr_receipt=o,t.miscSvc.mod_receipt(t.curr_receipt),t.receipt_updated=!0,t.stop_detect_receipt()),t.timeout_count+=1,t.timeout_count>t.threshold_timeout&&t.reset_if_no_pay()})()}compare_receipt(t,o){return t.datetime==o.datetime}set_old_receipt(){var t=this;return(0,b.Z)(function*(){""!==t.account_id?t.old_receipt=yield t.walletSvc.view("latest_transaction",{account:t.account_id}):t.toastSvc.present_toast("wallet account_id is invalid. Please login and wait 3 seconds.","top","bg-danger")})()}reset_if_no_pay(){this.stop_detect_receipt(),this.timeout_page=!0}reset_timeout(){this.timeout_page=!1,this.curr_receipt=null,this.unlock_price()}get imageHeight(){var t,o,c,a,l=null!==(t=null===(o=document.getElementById("container-center"))||void 0===o?void 0:o.offsetTop)&&void 0!==t?t:0,s=null!==(c=null===(a=document.getElementById("container-bottom"))||void 0===a?void 0:a.offsetTop)&&void 0!==c?c:300;return Math.round(.9*s)-l}openModal(){var t=this;return(0,b.Z)(function*(){const o=yield t.modalCtrl.create({component:$,componentProps:{qr_data:t.qr_data}});o.present();const c=yield t.brightness.getBrightness();t.brightness.setBrightness(1),o.onDidDismiss().then(()=>{c>=0&&c<=1?t.brightness.setBrightness(c):t.toastSvc.present_toast(`Get original brightness failed: ${c}`,"top","bg-danger",5e3)},a=>{t.toastSvc.present_toast(`Please report error: "qrcode modal dismiss: ${a}"`,"top","bg-danger",5e3)})})()}max_brightness(){this.brightness.getBrightness().then(t=>{this.curr_bright=t,this.brightness.setBrightness(1)})}reset_brightness(){this.curr_bright>=0&&this.curr_bright<=1&&this.brightness.setBrightness(this.curr_bright)}}return(n=i).\u0275fac=function(t){return new(t||n)(e.Y36(h.qu),e.Y36(G.g),e.Y36(S),e.Y36(ae.k),e.Y36(ce.Y),e.Y36(f.IN),e.Y36(Q))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-tab1"]],decls:7,vars:3,consts:[[1,"ion-no-border"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[4,"ngIf"],[1,"container-center"],[1,"display-6"],[1,"bg-danger"],[1,"text-center","text-light"],["id","container-top"],["id","container-center",1,"container-center"],["class","pt-3",4,"ngIf"],["size","large","color","medium",3,"click",4,"ngIf"],["size","large",3,"click"],["size","large","color","medium",3,"click"],["id","container-bottom",1,"container-bottom"],["size","large",3,"color","click"],[3,"name"],["novalidate","","autocomplete","off",3,"formGroup","ngSubmit"],["fill","outline","label","","formControlName","price","placeholder","0","type","number",1,"custom",3,"errorText"],["fill","clear",1,"custom",3,"click"],[3,"qrdata","elementType","width"],["class","text-center display-4",4,"ngIf"],[1,"text-center","display-4"],["size","large","color","secondary",3,"click"],["name","receipt-outline"],[1,"pt-3"],[1,"text-center"],["size","5",1,"fs-16","text-center"],["size","2",1,"fs-16","text-center"],["name","arrow-forward-outline"],["size","4"],["size","4",1,"fs-16","text-center"],["size","3",1,"fs-16","text-end"],["size","auto",1,"fs-16"],["name","hourglass-outline","aria-hidden","true",1,"timeout-icon"],[1,"display-3"],[3,"checked","disabled","ionChange",4,"ngIf"],[3,"checked","disabled","ionChange"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-header",0),e._UZ(1,"ion-toolbar"),e.qZA(),e.TgZ(2,"ion-content",1)(3,"ion-refresher",2),e.NdJ("ionRefresh",function(a){return o.handle_refresh(a)}),e._UZ(4,"ion-refresher-content"),e.qZA(),e.YNc(5,se,4,0,"ng-container",3)(6,we,16,6,"ng-container",3),e.qZA()),2&t&&(e.xp6(2),e.Q6J("fullscreen",!0),e.xp6(3),e.Q6J("ngIf",0===o.account_id.trim().length),e.xp6(1),e.Q6J("ngIf",0!==o.account_id.trim().length))},dependencies:[f.YG,f.PM,f.FN,f.Zi,f.Dq,f.wI,f.W2,f.jY,f.Gu,f.gu,f.pK,f.nJ,f.Wo,f.Nd,f.ho,f.sr,f.w,f.as,P.O5,h._Y,h.JJ,h.JL,h.sg,h.u,q],styles:["ion-input.custom[_ngcontent-%COMP%]{--padding-bottom: .7em;--padding-end: .4em;--padding-top: .7em;--border-width: 0em !important;font-size:4em;--placeholder-color: #c8c8c8 !important}.timeout-icon[_ngcontent-%COMP%]{font-size:18vmin;color:#d84747}ion-button.custom[_ngcontent-%COMP%]{--background-hover: white !important}"]}),i})()}];let ye=(()=>{var n;class i{}return(n=i).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[Z.Bz.forChild(xe),Z.Bz]}),i})(),Te=(()=>{var n;class i{}return(n=i).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[S,Q],imports:[f.Pc,P.ez,h.u5,h.UX,M.e,ye,F]}),i})()}}]);